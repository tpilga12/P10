\section{Implementation}
%%%%%%%%%%%% MID WAY AGENDA %%%%%%%%%%%%%%
%\begin{frame}<beamer>
%\frametitle{Thomas Holm Pilgaard}
%\tableofcontents[currentsection]
%\end{frame}
%%%%%%%%%%%% MID WAY AGENDA %%%%%%%%%%%%%%

\begin{frame}{Overview}{Jacob Naundrup Pedersen}
\begin{itemize}
	
\item Implementation
\item Control
\item Results
\item Discussion
\item Conclusion
\end{itemize}
\end{frame}

\begin{frame}{Implementation}{}

\begin{figure}[H]
\centering
\includegraphics[width=0.75 \textwidth]{figures/Basic_implementation}
\caption{Chosen structure of simulation environment.}
\label{fig:Basic_implementation}
\end{figure}


\end{frame}

\begin{frame}{Implementation}{Initialization}
    
\begin{table}[H]
\begin{enumerate} 
	\item Pipe
	\begin{itemize}
		\item Length [m]
		\item Sections (Number of sections the pipe should be split in to)
		\item $\text{S}_\text{b}$ (Slope) [\textperthousand]
		\item $\Delta$x = Length/Sections [m]
		\item Diameter [meter]
		\item Theta (parameter used in Preissmann scheme)
		\item $\text{Q}_{\text{f}}$[$\text{m}^\text{3}/\text{s}$]
		\item Side/lateral inflow present 
		\item Section location in data 
	\end{itemize}
	\item Tank
	\begin{itemize}
		\item Size [$\text{m}^\text{3}$]
		\item Height [m]
		\item Area = Size / Height [$\text{m}^\text{2}$]
		\item Maximum outflow [$\text{m}^\text{3}/\text{s}$]
		\item Section location in data 
	\end{itemize}
	
\end{enumerate}
\caption{List of parameters for pipe and tank.}
\label{tab:init_list}
\end{table}

\end{frame}


\begin{frame}{Implementation}{Initialization}
\begin{figure}[!h]
\centering
\includegraphics[width=0.97 \textwidth]{figures/Fredericia_pipe_setup2.PNG}
\caption{Setup in MATLAB of pipe specification of the main line in Fredericia.}
\label{fig:Fredericia_pipe_setup}
\end{figure}


\end{frame}
\begin{frame}{Implementation}{Initialization}
    \begin{figure}[H]
\centering
\includegraphics[width=0.5 \textwidth]{figures/tank_spec}
\caption{Setup in MATLAB of tank specifications.}
\label{fig:Fredericia_pipe_setup}
\end{figure}
\end{frame}

\begin{frame}{Implementation}{Initialization}
    
\begin{figure}[H]
\centering
\includegraphics[width=0.5 \textwidth]{figures/sys_setup_matlab.png}
\caption{Display of structure showing system setup information in MATLAB.}
\label{fig:sys_setup_matlab}
\end{figure}

\end{frame}

\begin{frame}{Implementation}{Initialization}
    \begin{figure}[H]
 \centering
 \input{figures/curvefit_comparison}
\caption{Comparison between data obtained by equation \ref{eq:calc_for_flowv2} and the same data curve fitted to a ninth order polynomial.}
\label{fig:curvefit_comparision}
\end{figure}
\end{frame}

\begin{frame}{Implementation}{Initialization}
\begin{figure}[H]
 \centering
 \input{figures/curvefit_comparison_split}
\caption{Comparison between data obtained by equation \ref{eq:calc_for_flowv2} and the same data curve fitted to a ninth order polynomial.}
\label{fig:curvefit_comparision_split}
\end{figure}


\end{frame}



\begin{frame}{Implementation}{Initialization}
 \begin{figure}[H]
 \centering
 \input{figures/fredericia_init_steady_state}
\caption{Height and flow of pipe setup from part of Fredericia where boundary conditions is found by fitted polynomial. Various amount of iterations, with constant flow input of 0,25 $\text{m}^\text{3}$/s, is performed. The dotted line indicates pipe intersections.}
\label{fig:fredericia_init_steady_state}
\end{figure}   


\end{frame}

\begin{frame}{Implementation}{Initialization}
 \begin{figure}[H]
 \centering
 \input{figures/fredericia_init_steady_state_lut}
\caption{Height and flow of pipe setup from part of Fredericia where boundary conditions is found by lookup table. Various amount of iterations, with constant flow input of 0,25 $\text{m}^\text{3}$/s, is performed. The dotted line indicates pipe intersections.}
\label{fig:fredericia_init_steady_state_lut}
\end{figure}   
\end{frame}



\begin{frame}{Implementation}{Simulation}
    \begin{itemize}
    	\item Preissmann scheme 
    \end{itemize}


\end{frame}

\begin{frame}{Implementation}{Display}
     \begin{figure}[h]
 \centering
 \includegraphics[width=1.0 \textwidth]{figures/display_result_matlab.png}
 \caption{%Screen shot of the plots made by the playback function where a sinusoidal flow input and step in concentrate is given, red dotted lines indicate pipe intersection and blue dotted lines are intersections with side inflow and stars are tanks inserted. In the simulation the pipe configuration seen in figure \ref{fig:Fredericia_pipe_setup} is used and input to the side inflows is not given.}
 }
 \label{fig:display_result_matlab}
 \end{figure}
\end{frame}


\section{Control}
\begin{frame}{Control}{Linearization}
    


\end{frame}
\begin{frame}{Control}{Linearization}
    


\end{frame}
\begin{frame}{Control}{Linearization}
    \begin{minipage}[t]{0.48\linewidth}
\begin{itemize}
	   	\item Sinus
	   	\item Flow profiles 
\end{itemize}    
\end{minipage}\hfill
\begin{minipage}[t]{0.48\linewidth}


\end{minipage}


\end{frame}

\begin{frame}{Control}{Linearization}
    
\begin{figure}[H]
\centering
\input{figures/linear_nonlinear_comparison_last_pipe}
\caption{Comparison of the nonlinear and linear model at the last pipe in the setup.}
\label{fig:linear_nonlinear_comparison_last_pipe}
\end{figure}

\end{frame}

\begin{frame}{Control}{MPC}
    
\begin{itemize}
	\item Cost function
	\item Constraints
	\item Linear model
\end{itemize}

\end{frame}

\begin{frame}{Control}{MPC}
    \begin{itemize}
    	\item Bestemmelse af Prediction horizon
    	\begin{itemize}
    		\item Flow profiler
    		\item Industri 
    	\end{itemize}
    	\item Begr√¶nsning af Prediction horizon
    \end{itemize}


\end{frame}

\begin{frame}{Control}{MPC}
 \begin{figure}[H]
 \centering
 \input{figures/MPC_test_output_first_test}
\caption{Output of the last pipe.}
\label{fig:MPC_test_output_first_test}
\end{figure}   


\end{frame}

\begin{frame}{Control}{MPC}
\begin{figure}[H]
 \centering
 \input{figures/tank_height_first_test}
\caption{Height in the tank.}
\label{fig:tank_height_first_test}
\end{figure}    


\end{frame}

\begin{frame}{Control}{MPC}
 \begin{figure}[H]
 \centering
 \input{figures/MPC_test_output_second_test_with_constraints}
\caption{Output of the last pipe in the second simulation run.}
\label{fig:MPC_test_output_second_test_with_constraints}
\end{figure}   


\end{frame}



\section{Results}

\begin{frame}{Results}{First test}
\begin{minipage}[t]{0.48\linewidth}
\begin{itemize}
	   	\item System setup
	   	\item Flow profiles 
\end{itemize}    
\end{minipage}\hfill
\begin{minipage}[t]{0.48\linewidth}
\begin{table}[H]
\centering
\begin{tabular}{|c|c|c|}
\hline
	\rowcolor[HTML]{9B9B9B} 
Type  & Component & Sections \\ \hline
Pipe  & 1         & 35       \\ \hline
Tank  & 1         & 1        \\ \hline
Pipe  & 17        & 207      \\ \hline
Tank  & 1         & 1        \\ \hline
Pipe  & 1         & 38        \\ \hline
Total & 21        & 282      \\ \hline
\end{tabular}
\caption{System setup.}
\label{tab:system_setup_nonlinear_linear_testv2}
\end{table}
\end{minipage}



\end{frame}

\begin{frame}{Results}{First test}
 \begin{figure}[H]
\centering
\input{figures/simulation_output_first}
\caption{Output of the last pipe into the WWTP.}
\label{fig:simulation_output_first}
\end{figure}     
\end{frame}

\begin{frame}{Results}{First test}
\begin{figure}[H]
\centering
\input{figures/simulation_output_first_concentration}
\caption{Simulation of COD output of the last pipe into the WWTP.}
\label{fig:simulation_output_first_concentration}
\end{figure}    
\end{frame}

\begin{frame}{Results}{Second test}
    
\begin{itemize}
	\item Over dimensioneret tank
	\item Konstant output af tank
\end{itemize}

\end{frame}


\begin{frame}{Results}{Second test}
\begin{figure}[H]
\centering
\input{figures/simulation_output_second_with_tank}
\caption{Output of the last pipe in to the WWTP, where a tank has been placed in front to reduce variation in flow into WWTP.}
\label{fig:simulation_output_second}
\end{figure} 
\end{frame}


\section{Discussion}
\begin{frame}{Discussion}{}
\begin{itemize}
	\item Courant's number
	\item Model reduction
\end{itemize}
\end{frame}

\section{Conclusion}

\begin{frame}{Conclusion}{}
\begin{itemize}
    	\item Simulation
    	\item MPC
\end{itemize}    


\end{frame}
